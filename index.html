<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Professional Prayer Times</title>
  <style>
    /* Reset & base */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    }

    body {
      background: #f2f7fa;
      color: #222;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 2rem 1rem;
    }

    /* Container */
    .container {
      width: 360px;
      background: white;
      border-radius: 16px;
      box-shadow: 0 8px 28px rgb(0 0 0 / 0.1);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      user-select: none;
      border: 1px solid #d1d9e6;
    }

    /* Header */
    .header {
      background: #238153;
      padding: 1.25rem 1.5rem;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      font-size: 1.1rem;
      letter-spacing: 0.03em;
      position: relative;
      font-feature-settings: "liga" off;
    }

    .header .date-text {
      flex: 1 1 auto;
    }

    .header .quran-icon {
      width: 32px;
      height: 32px;
      flex-shrink: 0;
      filter: drop-shadow(0 0 0.3rem #1a5e2c);
      user-select: none;
    }

    /* Location enable bar */
    .location-bar {
      background: #fbdde0;
      color: #d94e53;
      padding: 0.75rem 1.25rem;
      font-weight: 600;
      font-size: 0.9rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-radius: 0 0 18px 18px;
      border-top: 1px solid #f9b6b9;
      user-select: none;
    }

    .location-bar .icon {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 500;
      font-size: 0.95rem;
    }

    .location-bar button {
      background: none;
      border: none;
      color: #d94e53;
      font-weight: 700;
      cursor: pointer;
      font-size: 0.95rem;
      letter-spacing: 0.03em;
      transition: color 0.3s ease;
      user-select: none;
    }

    .location-bar button:hover {
      color: #b3393c;
    }

    /* Prayer card */
    .prayer-card {
      margin: 1.5rem;
      background: #2f6f35;
      border-radius: 12px;
      color: white;
      padding: 1rem 1.25rem;
      box-shadow: inset 0 -30px 50px rgb(255 255 255 / 0.1);
      user-select: none;
    }

    .prayer-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 700;
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
      letter-spacing: 0.03em;
    }

    .prayer-card-header .date-subtext {
      font-weight: 400;
      font-size: 0.9rem;
      opacity: 0.85;
      user-select: text;
    }

    .prayer-card-header button {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      font-size: 1.25rem;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: background 0.3s ease;
      user-select: none;
    }

    .prayer-card-header button:hover {
      background: rgba(255 255 255 / 0.2);
    }

    .prayer-card-header .calendar-icon {
      width: 26px;
      height: 26px;
      cursor: pointer;
      user-select: none;
      fill: white;
      transition: fill 0.3s ease;
    }

    .prayer-card-header .calendar-icon:hover {
      fill: #a8d5a3;
    }

    /* Prayer list vertical timeline */
    .prayer-list {
      background: white;
      border-radius: 12px;
      color: #222;
      padding: 1rem 1.25rem;
      margin-top: 0.5rem;
      box-shadow: 0 8px 18px rgb(0 0 0 / 0.08);
      position: relative;
      user-select: none;
    }

    .prayer-list::before {
      content: "";
      position: absolute;
      left: 28px;
      top: 1.5rem;
      bottom: 1.5rem;
      width: 4px;
      background: #afcba2;
      border-radius: 2px;
      opacity: 0.3;
      user-select: none;
    }

    .prayer-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.45rem 0;
      border-bottom: 1px solid #eee;
      position: relative;
      font-size: 1rem;
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    .prayer-item:last-child {
      border-bottom: none;
    }

    .prayer-item .time {
      font-weight: 400;
      color: #999;
      font-size: 0.95rem;
      letter-spacing: 0.05em;
      min-width: 60px;
      text-align: center;
    }

    .prayer-item .bell-icon {
      width: 22px;
      height: 22px;
      cursor: pointer;
      opacity: 0.35;
      transition: opacity 0.3s ease;
      user-select: none;
      fill: #666;
    }

    .prayer-item .bell-icon.active {
      opacity: 1;
      fill: #238153;
    }

    .prayer-item .bell-icon:hover {
      opacity: 0.7;
    }

    /* Timeline dots */
    .prayer-item::before {
      content: "";
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      width: 14px;
      height: 14px;
      background: #238153;
      border-radius: 50%;
      box-shadow: 0 0 8px #238153aa;
      user-select: none;
    }

    /* Responsive typography */
    @media (max-width: 400px) {
      .container {
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <main class="container" role="main" aria-label="Prayer times application">
    <header class="header">
      <div class="date-text" aria-live="polite" aria-atomic="true" id="headerDate">
        Fri 21 November 2025
      </div>
      <svg class="quran-icon" viewBox="0 0 64 64" aria-hidden="true" focusable="false">
        <path fill="#F7F7F7" d="M12 8h40v6H12z" />
        <path fill="#A1D99B" d="M20 14h24v34H20z" />
        <path fill="#74C476" d="M24 14v34M40 14v34" stroke="#238153" stroke-width="2" />
        <path fill="#238153" d="M32 20h8v4h-8zm0 10h8v4h-8z" />
      </svg>
    </header>

    <section class="location-bar" role="region" aria-label="Location permission request">
      <div class="icon" aria-hidden="true">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#d94e53" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round" aria-hidden="true" focusable="false">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="16" y1="12" x2="12" y2="12"></line>
        </svg>
        <span>For accurate prayer time</span>
      </div>
      <button id="enableLocationBtn" aria-label="Enable location for accurate prayer times">Enable location</button>
    </section>

    <article class="prayer-card" aria-label="Prayer times card">
      <header class="prayer-card-header" aria-live="polite" aria-atomic="true">
        <button id="prevDay" aria-label="Previous day" title="Previous day">&lt;</button>
        <div>
          <div id="hijriDate" style="font-weight: 700; font-size: 1.1rem;">30, Jumādā al-..</div>
          <div id="gregorianDate" style="font-weight: 400; font-size: 0.9rem;">Fri 21 November 2025</div>
        </div>
        <button id="nextDay" aria-label="Next day" title="Next day">&gt;</button>
        <button id="openCalendar" aria-label="Open calendar" title="Open calendar" style="margin-left: 8px;">
          <svg class="calendar-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2" fill="none" stroke="currentColor" stroke-width="2" />
            <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2" />
            <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2" />
            <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2" />
          </svg>
        </button>
      </header>

      <section class="prayer-list" role="list" aria-label="Prayer times">
        <div class="prayer-item" role="listitem">
          <div>Fajr</div>
          <div class="time" id="timeFajr">__ : __</div>
          <svg class="bell-icon" tabindex="0" role="button" aria-pressed="false" aria-label="Toggle alarm for Fajr"
            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round">
            <path d="M18 8a6 6 0 0 0-12 0c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
          </svg>
        </div>
        <div class="prayer-item" role="listitem">
          <div>Sunrise</div>
          <div class="time" id="timeSunrise">__ : __</div>
          <svg class="bell-icon" tabindex="0" role="button" aria-pressed="false" aria-label="Toggle alarm for Sunrise"
            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round">
            <path d="M18 8a6 6 0 0 0-12 0c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
          </svg>
        </div>
        <div class="prayer-item" role="listitem">
          <div>Dhuhr</div>
          <div class="time" id="timeDhuhr">__ : __</div>
          <svg class="bell-icon" tabindex="0" role="button" aria-pressed="false" aria-label="Toggle alarm for Dhuhr"
            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round">
            <path d="M18 8a6 6 0 0 0-12 0c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
          </svg>
        </div>
        <div class="prayer-item" role="listitem">
          <div>Asr</div>
          <div class="time" id="timeAsr">__ : __</div>
          <svg class="bell-icon" tabindex="0" role="button" aria-pressed="false" aria-label="Toggle alarm for Asr"
            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round">
            <path d="M18 8a6 6 0 0 0-12 0c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
          </svg>
        </div>
        <div class="prayer-item" role="listitem">
          <div>Maghrib</div>
          <div class="time" id="timeMaghrib">__ : __</div>
          <svg class="bell-icon" tabindex="0" role="button" aria-pressed="false" aria-label="Toggle alarm for Maghrib"
            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round">
            <path d="M18 8a6 6 0 0 0-12 0c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
          </svg>
        </div>
        <div class="prayer-item" role="listitem">
          <div>Isha</div>
          <div class="time" id="timeIsha">__ : __</div>
          <svg class="bell-icon" tabindex="0" role="button" aria-pressed="false" aria-label="Toggle alarm for Isha"
            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round">
            <path d="M18 8a6 6 0 0 0-12 0c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
          </svg>
        </div>
      </section>
    </article>
  </main>

  <script>
    // Utilities for formatting dates and times
    const dayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
    const monthNames = [
      "January",
      "February",
      "March",
      "April",
      "May",
      "June",
      "July",
      "August",
      "September",
      "October",
      "November",
      "December",
    ];

    // Hijri date conversion (simple approximation)
    // For production, use an API or a known library for accurate Hijri dates.
    function gregorianToHijri(gDate) {
      // This is a rough approximation using the Umm al-Qura calendar algorithm
      // More accurate results require an external API or library
      const jd = (gDate / 86400000) + 2440587.5;
      const islamicEpoch = 1948439.5;
      const daysSinceEpoch = jd - islamicEpoch;
      const islamicYear = Math.floor((30 * daysSinceEpoch + 10646) / 10631);
      const startOfYear = islamicYear * 10631 / 30 + islamicEpoch - 1;
      const month = Math.min(11, Math.floor((daysSinceEpoch - (startOfYear - islamicEpoch)) / 29.5));
      const day = Math.floor(daysSinceEpoch - (startOfYear - islamicEpoch) - (month * 29.5)) + 1;

      const monthNamesHijri = [
        "Muḥarram",
        "Ṣafar",
        "Rabīʿ al-Awwal",
        "Rabīʿ al-Thānī",
        "Jumādā al-Awwal",
        "Jumādā al-Thānī",
        "Rajab",
        "Shaʿbān",
        "Ramaḍān",
        "Shawwāl",
        "Dhū al-Qaʿdah",
        "Dhū al-Ḥijjah",
      ];

      return { year: islamicYear, month: monthNamesHijri[month], day: day };
    }

    // Prayer times calculation (simplified) using the Muslim World League method approximation
    // For production, use a dedicated library or API such as AlAdhan or PrayTimes.js

    // Coordinates default (set to Mecca)
    let userLatitude = 21.4225;
    let userLongitude = 39.8262;

    // Prayer names and offsets in minutes from solar noon (approximate)
    // These are approximate and for demo only
    const prayerOffsets = {
      Fajr: -90,
      Sunrise: -60,
      Dhuhr: 0,
      Asr: 60,
      Maghrib: 90,
      Isha: 120,
    };

    // Calculate prayer times based on date and location (very simplified solar times)
    function calculatePrayerTimes(date, latitude, longitude) {
      // Calculate Julian date
      const JDate = date.getTime() / 86400000 + 2440587.5;
      // Calculate approximate solar noon (UTC)
      const JTransit = Math.floor(JDate - 0.0009 - (longitude / 360)) + 0.0009 + (longitude / 360);
      // Solar declination approximation
      const n = JDate - 2451545.0;
      const L = (280.46 + 0.9856474 * n) % 360;
      const g = (357.528 + 0.9856003 * n) % 360;

      // Convert degrees to radians
      const rad = Math.PI / 180;
      const decl = Math.asin(Math.sin(g * rad) * Math.sin(23.44 * rad)) / rad;

      // Function to calculate time for given angle
      function timeForAngle(angle) {
        const ha = Math.acos(
          (Math.sin(angle * rad) - Math.sin(latitude * rad) * Math.sin(decl * rad)) / (Math.cos(latitude * rad) * Math.cos(decl * rad))
        ) / rad;
        return (12 - ha);
      }

      // Calculate prayer times in hours (UTC)
      let times = {};
      const Dhuhr = 12 - (longitude / 15);

      // Approximate times (hours)
      times.Dhuhr = Dhuhr;
      times.Fajr = Dhuhr - 1.5;
      times.Sunrise = Dhuhr - 1;
      times.Asr = Dhuhr + 1.5;
      times.Maghrib = Dhuhr + 2;
      times.Isha = Dhuhr + 3;

      // Convert to local time string hh:mm
      function toTimeString(t) {
        t = t + date.getTimezoneOffset() / 60; // Adjust for local timezone (offset is negative if ahead of UTC)
        if (t < 0) t += 24;
        if (t >= 24) t -= 24;
        const h = Math.floor(t);
        const m = Math.floor((t - h) * 60);
        return `${h.toString().padStart(2, "0")}:${m.toString().padStart(2, "0")}`;
      }

      return {
        Fajr: toTimeString(times.Fajr),
        Sunrise: toTimeString(times.Sunrise),
        Dhuhr: toTimeString(times.Dhuhr),
        Asr: toTimeString(times.Asr),
        Maghrib: toTimeString(times.Maghrib),
        Isha: toTimeString(times.Isha),
      };
    }

    // Elements
    const headerDateEl = document.getElementById("headerDate");
    const hijriDateEl = document.getElementById("hijriDate");
    const gregorianDateEl = document.getElementById("gregorianDate");

    const timeEls = {
      Fajr: document.getElementById("timeFajr"),
      Sunrise: document.getElementById("timeSunrise"),
      Dhuhr: document.getElementById("timeDhuhr"),
      Asr: document.getElementById("timeAsr"),
      Maghrib: document.getElementById("timeMaghrib"),
      Isha: document.getElementById("timeIsha"),
    };

    const enableLocationBtn = document.getElementById("enableLocationBtn");
    const prevDayBtn = document.getElementById("prevDay");
    const nextDayBtn = document.getElementById("nextDay");

    // Alarm toggle bells
    const bellIcons = document.querySelectorAll(".bell-icon");

    // State
    let currentDate = new Date(2025, 10, 21); // 21 November 2025 (month 0-indexed)
    let alarms = {
      Fajr: false,
      Sunrise: false,
      Dhuhr: false,
      Asr: false,
      Maghrib: false,
      Isha: false,
    };

    // Render date and prayers
    function render() {
      // Header date
      const optionsHeader = { weekday: "short", day: "2-digit", month: "long", year: "numeric" };
      headerDateEl.textContent = currentDate.toLocaleDateString("en-GB", optionsHeader);

      // Hijri date
      const hijri = gregorianToHijri(currentDate.getTime());
      let hijriDayStr = hijri.day;
      let hijriMonthStr = hijri.month.length > 12 ? hijri.month.substring(0, 12) + "..." : hijri.month;
      hijriDateEl.textContent = `${hijriDayStr}, ${hijriMonthStr}`;

      // Gregorian date subtext
      gregorianDateEl.textContent = headerDateEl.textContent;

      // Calculate prayer times
      const prayerTimes = calculatePrayerTimes(currentDate, userLatitude, userLongitude);

      Object.entries(prayerTimes).forEach(([prayer, time]) => {
        if (timeEls[prayer]) {
          timeEls[prayer].textContent = time;
        }
      });

      // Update alarm icons aria-pressed
      bellIcons.forEach((icon) => {
        const prayerName = icon.parentElement.querySelector("div:first-child").textContent.trim();
        const isActive = alarms[prayerName];
        icon.classList.toggle("active", isActive);
        icon.setAttribute("aria-pressed", isActive ? "true" : "false");
      });
    }

    // Location enable handler
    enableLocationBtn.addEventListener("click", () => {
      if (!navigator.geolocation) {
        alert("Geolocation is not supported by your browser.");
        return;
      }
      enableLocationBtn.disabled = true;
      enableLocationBtn.textContent = "Locating...";
      navigator.geolocation.getCurrentPosition(
        (position) => {
          userLatitude = position.coords.latitude;
          userLongitude = position.coords.longitude;
          enableLocationBtn.textContent = "Location enabled";
          enableLocationBtn.style.color = "#238153";
          enableLocationBtn.disabled = true;
          render();
        },
        () => {
          alert("Unable to retrieve your location.");
          enableLocationBtn.textContent = "Enable location";
          enableLocationBtn.disabled = false;
        }
      );
    });

    // Day navigation handlers
    prevDayBtn.addEventListener("click", () => {
      currentDate.setDate(currentDate.getDate() - 1);
      render();
    });
    nextDayBtn.addEventListener("click", () => {
      currentDate.setDate(currentDate.getDate() + 1);
      render();
    });

    // Bell icon alarm toggle
    bellIcons.forEach((icon) => {
      icon.addEventListener("click", () => {
        const prayerName = icon.parentElement.querySelector("div:first-child").textContent.trim();
        alarms[prayerName] = !alarms[prayerName];
        render();
      });
      icon.addEventListener("keydown", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          icon.click();
        }
      });
    });

    // Initial render
    render();
  </script>
</body>

</html>